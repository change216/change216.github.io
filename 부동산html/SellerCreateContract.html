
<html>

    <head>
        <title>IPFS Image Upload</title>
      
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>
        <script src="https://cdn.rawgit.com/ethereumjs/browser-builds/ddb27f8d/dist/ethereumjs-tx/ethereumjs-tx-1.3.3.min.js"></script>
        <script src="https://unpkg.com/ipfs-api/dist/index.min.js"></script>
      
        <link rel="stylesheet" href="assets/css/style.min.css">
        <link rel="stylesheet" href="assets/css/modules.css">
      
        <style>
        </style>
      
      </head>

      <body>
          <!--타이틀-->
        <section class="MOD_HERO" style="background-image:url(assets/css/3.png)">
            <div data-layout="_r">
              <div data-layout="de10">
                <h1>계약 관리(판매자)</h1>
                <h3>계약을 생성하고 거래를 진행합니다.</h3>
               
              </div>
            </div>
          </section>

          <!--상태바 메뉴-->
          <section class="MOD_MENU" data-theme="_bgp">
            <div data-layout="_r" class="nopadding">
                <nav class="MOD_MENU_Nav">
                    <!-- <p class="MOD_MENU_Title">Menu</p> -->
                                    
                    <!-- <svg class="MOD_MENU_Button" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="30px" viewBox="0 0 30 30" enable-background="new 0 0 30 30" xml:space="preserve">
                        <rect width="30" height="6"/>
                        <rect y="24" width="30" height="6"/>
                        <rect y="12" width="30" height="6"/>
                    </svg> -->
    
                    <ul class="AP_Menu_List">
                        <li>
                            <a href="#" class="Homebtn" style="background-image: url(assets/css/Home.png);background-repeat: no-repeat; background-size: contain; 	background-position: center;" onclick="self.location='http://localhost:2001/부동산html/Main.html';"></a>
                        </li>
                        <li>
                                <a href="#" data-theme="_bgp">마이페이지 </a>
                                <ul>
                                        <li>
                                            <a href="#" data-theme="_bgpd"  onclick="self.location='http://localhost:2001/부동산html/UploadDocument.html';">서류 등록</a>
                                        </li>
                                        <li>
                                            <a href="#" data-theme="_bgpd" onclick="self.location='http://localhost:2001/부동산html/MyDocument.html';" >내 서류</a>
                                        </li>
                                        <li>
                                            <a href="#" data-theme="_bgpd"  onclick="self.location='http://localhost:2001/부동산html/UpdateDocument.html';">내 서류 변경</a>
                                        </li>
                                        <li>
                                            <a href="#" data-theme="_bgpd" >내 서류 열람 허가</a>
                                        </li>
                                </ul>
                        </li>
                         
                        <li>
                            <a href="#" data-theme="_bgp" >판매자</a>
                            <ul>
                                <li>
                                    <a href="#" onclick="self.location='http://localhost:2001/부동산html/Setseller.html';" data-theme="_bgpd">판매자 등록</a>
                                </li>
                                <li>
                                    <a href="#" onclick="self.location='http://localhost:2001/부동산html/UploadProduct.html';" data-theme="_bgpd">매물 등록</a>
                                </li>
                                <li>
                                    <a href="#" onclick="self.location='http://localhost:2001/부동산html/UpdateProduct.html';" data-theme="_bgpd">매물 변경</a>
                                </li>
                                <li>
                                    <a href="#" onclick="self.location='http://localhost:2001/부동산html/CreateContract.html';" data-theme="_bgpd">계약 생성하기</a>
                                </li>
                                <li>
                                    <a href="#" data-theme="_bgpd">내 매물</a>
                                </li>
                            </ul>
                        </li>
    
                        <li>
                            <a href="#" data-theme="_bgp">구매자</a>
                            <ul>
                                    <li>
                                        <a href="#" onclick="self.location='http://localhost:2001/부동산html/Setbuyer.html';" data-theme="_bgpd">구매자 등록</a>
                                    </li>
                                </ul>
                        </li>
    
                        <li>
                            <a href="#" data-theme="_bgp">메뉴 4</a>
                        </li>
                        <li>
                            <a href="#" data-theme="_bgp">메뉴 5</a>
                        </li>
                        <li>
                            <a href="#" data-theme="_bgp">메뉴 6</a>
                            <ul>
                                <li>
                                    <a href="#" data-theme="_bgpd">Sub-Menu Item</a>
                                </li>
                                <li>
                                    <a href="#" data-theme="_bgpd">Sub-Menu Item long title</a>
                                </li>
                                <li>
                                    <a href="#" data-theme="_bgpd">Sub-Menu Item</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </section>

        <!--카테고리분류-->
        <section class="MOD_SUBNAVIGATION1">
                <div data-layout="_r">
                  <div data-layout="al16 al-o2 de-o1 de6 ec4">
                    <nav class="MOD_SUBNAVIGATION1_Menu" data-theme="_bo2">
                      <p class="MOD_SUBNAVIGATION1_Menutitle" data-theme="_bgs"></p>
                      <ul>
                          <li>
                              <a href="#">ALL</a>
                          </li>
                          <li>
                              <a  href="#">아파트</a>
                          </li>
                          <li>
                              <a  href="#">빌라</a>
                          </li>
                          <li>
                              <a  href="#">주택</a>
                          </li>
                          <li>
                              <a  href="#">미정</a>
                          </li>
                          <li>
                              <a href="#">미정</a>
                          </li>
                          <li>
                              <a href="#">미정</a>
                          </li>
                      
                      </ul>
                    </nav>
                  </div> 
        
                  <div data-layout="al-o1 de-o2 de10" class="MOD_SUBNAVIGATION1_Page">
                        <section>
                            <div data-layout="_r" class="MOD_IMPACTSTRIP3">
        
                                <div data-layout="al16 de8" class="MOD_IMPACTSTRIP3_TxtContainer" data-theme="_bgd">
        
                                    <div class="MOD_IMPACTSTRIP3_Txt">
                                        <h2 data-theme="_bo3">구매요청 확인하기</h2>
                                        
                                        <ui>
                                           <li> 매물 인덱스 <input type="text" id="product_index"/><button type="button" onclick="createTrans()" >계약만들기</button> 
                                            <li>계약 트랜잭션 id : <span id="trans_txid"></span></li>
                                           </ui>
                                        
                                        <button id='MyRequest' type="button" onclick="LoadRequsetList()"> 요청목록 불러오기</button>
                                       
                                        
                                      
                                        <table id="table1"/>
     
                                    </div>
                                </div>
                                
                                        <h2 data-theme="_bo3">거래 현황보기</h2>
                                        
                                        <ui>
                                           <li> 계약 트랜잭션 id  <input type="text" id="trans_txid2"/>
                                            <button type="button" onclick="TransState()" >상태불러오기</button>
                                         </li>
                                            <li> 거래 현재상태 : <span id="trans_state"></span> 
                                            </li>
                                        </ui>
                                        
                                        <button id='MyRequest' type="button" onclick="transClose()"> 거래 완료하기 </button>
                                        <button id='MyRequest' type="button" onclick="transAllClose()"> 거래 취소하기 </button>
                                    
     
                                    </div>
                            </div>
                         
           
</section></section>
      </body>

    <script type="text/javascript">
    var contractAddress = '0x889f55a6a9fc273c443c7db6233111ad74840af6';
    var RealEstateTransactionContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"_index","type":"uint256"},{"name":"_addr","type":"address"},{"name":"_price","type":"uint256"},{"name":"_owner","type":"address"}],"name":"SetRoomconAddr","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"buyerDetail","outputs":[{"name":"flag","type":"bool"},{"name":"id","type":"string"},{"name":"name","type":"string"},{"name":"Tell","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"}],"name":"favoriteProduct","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_index","type":"uint256"}],"name":"GetMyProduct","outputs":[{"name":"","type":"string"},{"name":"","type":"uint256"},{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"address"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"productArray","outputs":[{"name":"ProductAddress","type":"string"},{"name":"ProductInfo","type":"string"},{"name":"Price","type":"uint256"},{"name":"Tag","type":"string"},{"name":"ProductName","type":"string"},{"name":"ImageHashsrc","type":"string"},{"name":"owner","type":"address"},{"name":"Productnumber","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_index","type":"uint256"}],"name":"IndexToPrice","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"GetMyProductnumber","outputs":[{"name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_index","type":"uint256"}],"name":"IndexToContract","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"GetProdctsSize","outputs":[{"name":"count","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getSellerScore","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"},{"name":"score","type":"uint256"}],"name":"SellerEvaluation","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_index","type":"uint256"}],"name":"IndexToOwner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_id","type":"string"},{"name":"_tell","type":"uint256"}],"name":"setBuyer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_ImageHashsrc","type":"string"},{"name":"_ProductAddress","type":"string"},{"name":"_ProductInfo","type":"string"},{"name":"_Price","type":"uint256"},{"name":"_Tag","type":"string"},{"name":"_ProductName","type":"string"}],"name":"SetUploadProduct","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_applicant","type":"address"},{"name":"_span","type":"uint256"}],"name":"SetAllowMyDocument","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product_index","type":"uint256"},{"name":"_ImageHashsrc","type":"string"},{"name":"_ProductAddress","type":"string"},{"name":"_ProductInfo","type":"string"},{"name":"_Price","type":"uint256"},{"name":"_Tag","type":"string"},{"name":"_ProductName","type":"string"}],"name":"SetUpdateProduct","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"},{"name":"myaddress","type":"address"}],"name":"setTransOwner","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"favoriteProductresult","outputs":[{"name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"}],"name":"BuyRequestListPush","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_id","type":"string"},{"name":"_tell","type":"uint256"}],"name":"setSeller","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"sellerDetail","outputs":[{"name":"flag","type":"bool"},{"name":"Tell","type":"uint256"},{"name":"reliability","type":"uint256"},{"name":"Status_Numberofpeople","type":"uint256"},{"name":"Status_sum","type":"uint256"},{"name":"Status_avg","type":"uint256"},{"name":"id","type":"string"},{"name":"name","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_id","type":"string"}],"name":"getMyAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_DocumentName","type":"string"},{"name":"_DocumentImageHashsrc","type":"string"},{"name":"_DocumentImageInfo","type":"string"}],"name":"SetUploadMyDocument","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"DocumentArray","outputs":[{"name":"DocumentName","type":"string"},{"name":"DocumentImageHashsrc","type":"string"},{"name":"DocumentImageInfo","type":"string"},{"name":"Documentowner","type":"address"},{"name":"Documentnumber","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"GetRoomcontractSize","outputs":[{"name":"count","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"},{"name":"_val","type":"uint256"}],"name":"SetRoomconValue","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_index","type":"uint256"},{"name":"_DocumentName","type":"string"},{"name":"_DocumentImageHashsrc","type":"string"},{"name":"_DocumentImageInfo","type":"string"}],"name":"SetUpdateMyDocument","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"RoomcontractList","outputs":[{"name":"transaddr","type":"address"},{"name":"buyer","type":"address"},{"name":"seller","type":"address"},{"name":"price","type":"uint256"},{"name":"product_index","type":"uint256"},{"name":"timestamp","type":"uint256"},{"name":"statevalue","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_index","type":"uint256"}],"name":"getRoomconStateValue","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_person","type":"address"},{"name":"_index","type":"uint256"}],"name":"getBuyerDocument","outputs":[{"name":"_allowReference","type":"bool"},{"name":"_approveBlockNo","type":"uint256"},{"name":"_refLimitBlockNo","type":"uint256"},{"name":"_applicant","type":"address"},{"name":"_DocumentName","type":"string"},{"name":"_DocumentImageHashsrc","type":"string"},{"name":"_DocumentImageInfo","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getDocumentList","outputs":[{"name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"getType","outputs":[{"name":"","type":"int256"}],"payable":false,"stateMutability":"view","type":"function"}]);
    var RealEstateTransactionStorage;
    var transContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"members","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"sellingPrice","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"con_owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"Allclose","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"deadline","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_id","type":"string"}],"name":"pay","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"close","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"isOpened","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"price","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_new","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"_temps","type":"address"},{"name":"_index","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"salesVolum","type":"uint256"},{"indexed":false,"name":"sellingPrice","type":"uint256"},{"indexed":false,"name":"deadline","type":"uint256"},{"indexed":false,"name":"beneficiary","type":"address"}],"name":"EscrowStart","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"addr","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"ConfirmedPayment","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"oldaddr","type":"address"},{"indexed":false,"name":"newaddr","type":"address"}],"name":"TransferOwnership","type":"event"}]);
    var transStorage;
    var transaddress;
    var myAccount;

    window.addEventListener('load', function () {

    // Checking if Web3 has been injected by the browser (Mist/MetaMask)
    if (typeof web3 !== 'undefined') {
    // Use Mist/MetaMask's provider
    window.web3 = new Web3(web3.currentProvider);
    } else {
    console.log('No web3? You should consider trying MetaMask!')
    // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
    window.web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:7001"));
    }
    

    // Now you can start your app & access web3 freely:
    startApp();
    });

    function startApp() {

    RealEstateTransactionStorage = RealEstateTransactionContract.at(contractAddress);
    web3.eth.getAccounts(function(e,r){ 
        myAccount= r[0]; 
     })

    }

    function LoadRequsetList() {

        var table = document.getElementById('table1');
        for(let i =0; i<10;i++){ //전체 배열length받는 함수 작성하거나 방법 찾아야함 임시임

            RealEstateTransactionStorage.BuyRequestList(i,function(e,r){
                if(r[1]==myAccount){
                    //tablepush(r);

                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    cell1.innerHTML = "*구매요청자 주소: " + r[0];
                    cell2.innerHTML = ",   요청 매물 인덱스: " + r[2];
                    console.log(r);
                }
                })
        }
    }

    function createTrans() {

        var _index = document.getElementById('product_index').value;
        trans = transContract.new(
            contractAddress,
            _index,
            {
                from: web3.eth.accounts[0], 
                data: '0x608060405234801561001057600080fd5b506040516040806110388339810180604052810190808051906020019092919080519060200190929190505050336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550806006819055508160096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663240e807b826040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050602060405180830381600087803b15801561025557600080fd5b505af1158015610269573d6000803e3d6000fd5b505050506040513d602081101561027f57600080fd5b810190808051906020019092919050505060078190555060096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166372f897a8826040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050602060405180830381600087803b15801561038657600080fd5b505af115801561039a573d6000803e3d6000fd5b505050506040513d60208110156103b057600080fd5b8101908080519060200190929190505050600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506007546001819055506001600860006101000a81548160ff0219169083151502179055505050610c02806104366000396000f3006080604052600436106100a4576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806308ae4b0c146100a957806312821b5e1461012c57806321d5f5de1461015757806328dbec31146101ae57806329dcb0cf146101c55780632b66d72e146101f057806343d726d61461024c578063692aa97e14610263578063a035b1fe14610292578063f2fde38b146102bd575b600080fd5b3480156100b557600080fd5b506100ea600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610300565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561013857600080fd5b50610141610333565b6040518082815260200191505060405180910390f35b34801561016357600080fd5b5061016c610339565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156101ba57600080fd5b506101c361035e565b005b3480156101d157600080fd5b506101da610399565b6040518082815260200191505060405180910390f35b61024a600480360381019080803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929050505061039f565b005b34801561025857600080fd5b506102616107c2565b005b34801561026f57600080fd5b50610278610a40565b604051808215151515815260200191505060405180910390f35b34801561029e57600080fd5b506102a7610a53565b6040518082815260200191505060405180910390f35b3480156102c957600080fd5b506102fe600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610a59565b005b60096020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60015481565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60025481565b6000600860009054906101000a900460ff1615156103bc57600080fd5b3490506001548110156103ce57600080fd5b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1660096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c4e04aa1846040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825283818151815260200191508051906020019080838360005b838110156105105780820151818401526020810190506104f5565b50505050905090810190601f16801561053d5780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b15801561055c57600080fd5b505af1158015610570573d6000803e3d6000fd5b505050506040513d602081101561058657600080fd5b810190808051906020019092919050505073ffffffffffffffffffffffffffffffffffffffff161415156105b957600080fd5b60096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a82569e0600654336040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b1580156106df57600080fd5b505af11580156106f3573d6000803e3d6000fd5b5050505033600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000600860006101000a81548160ff0219169083151502179055507fc85e69f622563cd1ca95cff8bc4a6b00684777d35069f350365d996d5774b1813382604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a15050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561081d57600080fd5b60096000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166353d050cb30600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff166007546040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001945050505050600060405180830381600087803b1580156109ee57600080fd5b505af1158015610a02573d6000803e3d6000fd5b505050506000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b600860009054906101000a900460ff1681565b60075481565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610ab657600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050816000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f5c486528ec3e3f0ea91181cff8116f02bfa350e03b8b6f12e00765adbb5af85c816000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a150505600a165627a7a72305820b1f65fb354b6e444523b96c4f345204bf9d35d32b346b05aafa33bd3d06f0a7b0029', 
                gas: '4700000'
            }, function (e, contract){
                console.log(e, contract);
                if (typeof contract.address !== 'undefined') {
                    console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                    document.getElementById('trans_txid').innerHTML = contract.address;
                }
            })

    }

    function TransState() {

        transaddress= document.getElementById('trans_txid2').value;
        transStorage = transContract.at(transaddress);
        transStorage.isOpened(function(e,r){
            console.log(r);

            if(r) {document.getElementById('trans_state').innerHTML = '<span style="color: red; font-weight:bold">입금 대기중..</span>' }
            else if(r==false) {document.getElementById('trans_state').innerHTML = '<span style="color: green; font-weight:bold">입금 완료!</span>' }
            else {document.getElementById('trans_state').innerHTML = '<span style="color: black; font-weight:bold">없는거래 혹은 완료된거래?</span>' }
            
            });
    }

    function transClose() {
        transaddress= document.getElementById('trans_txid2').value;
        transStorage = transContract.at(transaddress);
        transStorage.close(function(e,r){
            if(!e) {document.getElementById('trans_state').innerHTML = '<span style="color: blue; font-weight:bold, font-size: large" >거래가 완료 되었습니다!</span>' }
           
        })
    }

    function transAllClose() {
        transaddress= document.getElementById('trans_txid2').value;
        transStorage = transContract.at(transaddress);
        transStorage.Allclose(function(e,r){
            if(!e) {document.getElementById('trans_state').innerHTML = '<span style="color: blue; font-weight:bold, font-size: large" >거래가 취소 되었습니다!</span>' }
           
        })
    }

    </script>
</html>